(this["webpackJsonpclient-cra"]=this["webpackJsonpclient-cra"]||[]).push([[0],{22:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageEvents={COMPASS_STATE:"CMP-STATE",GET_COMPASS_STATE:"GET-CMP-STATE",CALIBRATE_COMPASS:"CMP-CAL",AHRS:"AHRS",AUTOPILOT:"AUTOPILOT",LOG:"LOG"}},71:function(e,t,a){e.exports=a(89)},86:function(e,t){e.exports={"motor-light":{text:"Motor - light conditions",values:{rudderTime:200,rudderWait:200,kP:15,kI:1,kD:1}},"sail-light":{text:"Sailing - light conditions",values:{rudderTime:200,rudderWait:200,kP:60,kI:6,kD:2}},"sail-light-med-downhill":{text:"Sailing - light/med downhill",values:{rudderTime:200,rudderWait:200,kP:100,kI:4,kD:2}},"sail-med-heavy-downhill":{text:"Sailing - med/heavy downhill",values:{rudderTime:200,rudderWait:400,kP:300,kI:4,kD:3}}}},89:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(14),c=a.n(r);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=a(24),i=a(30),o=(a(76),a(77),a(42)),s=a(41),m=a(94),d=a(61),E=a(59),f=a(22),h=a(27),b=new WebSocket("ws://".concat(window.location.hostname,":3001/ws")),g={};b.onmessage=function(e){var t=JSON.parse(e.data),a=t.event,n=t.data;g[a].forEach((function(e){return e(n)}))},b.onopen=function(){v(f.MessageEvents.AUTOPILOT),v(f.MessageEvents.LOG),v(f.MessageEvents.COMPASS_STATE),v(f.MessageEvents.AHRS)};var v=Object(h.memoize)((function(e){g[e]=g[e]||[],b.send(JSON.stringify({cmd:"register",data:{event:e}}))})),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b.send(JSON.stringify({cmd:"send",data:Object(E.a)({event:e},t)}))},y=function(e,t){g[e]=g[e]||[],g[e].push(t)},O=function(e,t){Object(h.pull)(g[e],t)},k=function(){var e=Object(n.useState)({}),t=Object(s.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)({}),u=Object(s.a)(c,2),i=u[0],o=u[1];return Object(n.useEffect)((function(){y(f.MessageEvents.COMPASS_STATE,r);var e=setInterval((function(){return p(f.MessageEvents.GET_COMPASS_STATE)}),2e3);return function(){clearInterval(e),O(f.MessageEvents.COMPASS_STATE,r)}}),[]),Object(n.useEffect)((function(){return y(f.MessageEvents.AHRS,o),function(){O(f.MessageEvents.AHRS,o)}}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement(m.a,{style:{width:0}},l.a.createElement("tbody",null,l.a.createElement(j,{label:"Magnetometer Cal"},a.magCal),l.a.createElement(j,{label:"Accelerometer Cal"},a.accCal),l.a.createElement(j,{label:"Gyro Cal"},a.gyroCal),l.a.createElement(j,{label:"Compass Cal"},a.cmpCal),l.a.createElement(j,{label:"Heading"},i.heading))),l.a.createElement(d.a,{onClick:function(){return p(f.MessageEvents.CALIBRATE_COMPASS)}},a.isCal?"Calibrating...":"Calibrate"))},j=function(e){var t=e.label,a=e.children;return l.a.createElement("tr",null,l.a.createElement("td",null,t,":"),l.a.createElement("td",null,a))},x=a(100),S=a(70),T=function(){return l.a.createElement(x.a,null,l.a.createElement(S.a,null,l.a.createElement(u.b,{to:"/log"},"Log")),l.a.createElement(S.a,null,l.a.createElement(u.b,{to:"/autopilot"},"Autopilot")),l.a.createElement(S.a,null,l.a.createElement(u.b,{to:"/compass"},"Compass")),l.a.createElement(S.a,null,l.a.createElement(u.b,{to:"/systems"},"Systems")))},A=function(){return l.a.createElement("div",null,"This is home")},C=a(20),M=a(5),I=M.l.array([]),L=I.clear.bind(I);y("LOG",(function(e){return console.log(e)||I.push(e)}));var w=Object(C.a)((function(){return l.a.createElement("div",null,l.a.createElement("button",{onClick:L},"Clear"),I.map((function(e,t){return l.a.createElement("div",{key:t},e.level,": ",e.msg)})))})),P=a(10),D=a(8),R=a(12),H=a(11),U=a(13),W=a(98),_=a(97),V=a(96),z=a(99),N=l.a.Component,G=a(36);y("AUTOPILOT",(function(e){B.merge(e)}));var B=M.l.map(),F=function(e){return p("AUTOPILOT",{data:e})},J=a(95),K=a(48),Z=a(86),$=a(27),q=Object(C.a)(function(e){function t(){return Object(P.a)(this,t),Object(R.a)(this,Object(H.a)(t).apply(this,arguments))}return Object(U.a)(t,e),Object(D.a)(t,[{key:"updatePresets",value:function(e){F({preset:e})}},{key:"render",value:function(){var e=this;return G.Maybe.of(B.get("preset")).map((function(t){return l.a.createElement(J.a,{id:"preset-select",onSelect:e.updatePresets.bind(e),title:$.get(Z[t],"text")},$.map(Z,(function(e,t){return l.a.createElement(K.a.Item,{key:t,eventKey:t},e.text)})))})).getOrElse(null)}}]),t}(N)),Q=function(e){var t=e.children;return l.a.createElement(V.a,{xs:4},l.a.createElement("label",null,t,":"))},X=function(e){var t=e.children;return l.a.createElement(V.a,{xs:8},t)},Y=function(e){var t=e.label,a=e.children;return l.a.createElement(_.a,null,l.a.createElement(Q,null,t),l.a.createElement(X,null,void 0===a?"undefined":"object"===typeof a?a:a.toString()))},ee=function(e){var t=e.children;return Object(h.isNumber)(t)?te(t):"N/A"},te=function(e){var t=ae(e,3),a="black";return e>0&&(a="green"),e<0&&(a="red"),l.a.createElement("span",{style:{color:a}},t)},ae=function(e,t){return parseFloat(parseFloat(e,10).toFixed(t))},ne=Object(C.a)(function(e){function t(){return Object(P.a)(this,t),Object(R.a)(this,Object(H.a)(t).apply(this,arguments))}return Object(U.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(Y,{label:"Course"},Object(h.isNil)(B.get("course"))?"---":B.get("course")),l.a.createElement(Y,{label:"Heading"},B.get("heading")),l.a.createElement(Y,{label:"Error"},l.a.createElement(ee,null,B.get("error"))),l.a.createElement(Y,{label:"Rudder"},l.a.createElement(ee,null,void 0===B.get("course")?"N/A":B.get("rudder"))," "))}}]),t}(N)),le=a(32),re=a(6),ce=a(88)({cmd:"cmd",ctrl:"ctrl",alt:"alt",shift:"shift",joinWith:"-"}),ue=[{key:"rudderTime",text:"RudderTime",inc:10},{key:"rudderWait",text:"Rudder Wait",inc:10},{key:"kP",text:"P",inc:1},{key:"kI",text:"I",inc:1},{key:"kD",text:"D",inc:1}],ie=Object(C.a)(function(e){function t(e){var a;return Object(P.a)(this,t),(a=Object(R.a)(this,Object(H.a)(t).call(this,e))).state={adjustableValueIdx:0},a.keyUpListener=a.onKeyUp.bind(Object(re.a)(a)),document.addEventListener("keyup",a.keyUpListener),a}return Object(U.a)(t,e),Object(D.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.keyUpListener)}},{key:"onKeyUp",value:function(e){var t=ce(e);"Down"===t&&this.downArrow(),"Up"===t&&this.upArrow(),"shift-Left"===t&&this.shiftLeft(),"shift-Right"===t&&this.shiftRight()}},{key:"downArrow",value:function(){this.setState({adjustableValueIdx:this.state.adjustableValueIdx<ue.length-1?this.state.adjustableValueIdx+1:0})}},{key:"upArrow",value:function(){this.setState({adjustableValueIdx:0===this.state.adjustableValueIdx?Object.keys(ue).length-1:this.state.adjustableValueIdx-1})}},{key:"shiftLeft",value:function(){var e=ue[this.state.adjustableValueIdx];F(Object(le.a)({},e.key,B.get(e.key)-e.inc))}},{key:"shiftRight",value:function(){var e=ue[this.state.adjustableValueIdx];F(Object(le.a)({},e.key,B.get(e.key)+e.inc))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,ue.map((function(t,a){return l.a.createElement(Y,{key:t.key,label:t.text},l.a.createElement("span",{key:t.key,style:a===e.state.adjustableValueIdx?oe.highlighted:{}},B.get(t.key)))})))}}]),t}(N)),oe={highlighted:{backgroundColor:"black",color:"white"}},se=Object(C.a)(function(e){function t(e){var a;return Object(P.a)(this,t),a=Object(R.a)(this,Object(H.a)(t).call(this,e)),B.get("voltage")||B.set("voltage",1023),a.maxDly=0,a.maxMaxDly=0,a.minHz=999999,setInterval((function(){return a.minHz=999999}),5e3),setInterval((function(){a.maxMaxDly=Math.max(a.maxMaxDly,a.maxDly),a.maxDly=0}),3e5),a}return Object(U.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){return this.maxDly=isNaN(this.maxDly)?0:Math.max(B.get("compassDelay"),this.maxDly),this.minHz=Math.min(B.get("hz"),this.minHz),l.a.createElement("div",null,l.a.createElement(Y,{label:"Roll"},l.a.createElement(ee,null,B.get("roll"))),l.a.createElement(Y,{label:"Pitch"},l.a.createElement(ee,null,B.get("pitch"))," "),l.a.createElement(Y,{label:"HZ"},B.get("hz")),l.a.createElement(Y,{label:"Min HZ"},this.minHz),l.a.createElement(Y,{label:"R State"},B.get("rudderState")),l.a.createElement(Y,{label:"Base"},B.get("prevBase")),l.a.createElement(Y,{label:"Tach"},B.get("prevTach")),l.a.createElement(Y,{label:"Speed"},B.get("prevSpeed")),l.a.createElement(Y,{label:"Cmps Dly"},B.get("compassDelay")),l.a.createElement(Y,{label:"Max Dly"},this.maxDly," (",this.maxMaxDly,")"))}}]),t}(N)),me=function(e){function t(e){var a;return Object(P.a)(this,t),a=Object(R.a)(this,Object(H.a)(t).call(this,e)),document.addEventListener("keyup",a.keyListener),a}return Object(U.a)(t,e),Object(D.a)(t,[{key:"keyListener",value:function(e){!1===e.shiftKey&&("KeyC"===e.code&&G.Either.of(B.get("course")).cata((function(){return F({course:B.get("heading")})}),(function(){return F({course:null})})),"ArrowRight"===e.code&&G.Maybe.of(B.get("course")).map((function(e){return 359===e?0:e+1})).map((function(e){return B.set("course",e),e})).map((function(e){return F({course:e})})),"ArrowLeft"===e.code&&G.Maybe.of(B.get("course")).map((function(e){return F({course:e?e-1:359})})))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.keyListener)}},{key:"render",value:function(){return l.a.createElement(W.a,{fluid:!0},l.a.createElement(_.a,null,l.a.createElement(V.a,{style:{paddingBottom:5}},l.a.createElement(q,null))),l.a.createElement(_.a,null,l.a.createElement(V.a,{xs:6},l.a.createElement(z.a,null,l.a.createElement(ne,null),l.a.createElement(ie,null))),l.a.createElement(V.a,{xs:6},l.a.createElement(z.a,null,l.a.createElement(se,null)))))}}]),t}(N),de=function(e){var t=e.children,a=(e.system,e.withPasscode,Object(n.useState)(!1)),r=Object(s.a)(a,2),c=r[0],u=r[1];Object(n.useEffect)((function(){setTimeout((function(){return u(!0)}),5e3)}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(d.a,{variant:"primary",onClick:function(){},active:c},t))},Ee=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(de,null,"Pump out"))},fe=function(){return l.a.createElement(o.a,{orientation:"vertical"},l.a.createElement(o.b,{flex:.2},l.a.createElement(T,null)),l.a.createElement(o.c,null),l.a.createElement(o.b,null,l.a.createElement(i.c,null,l.a.createElement(i.a,{path:"/log",component:w}),l.a.createElement(i.a,{path:"/autopilot",component:me}),l.a.createElement(i.a,{path:"/compass",component:k}),l.a.createElement(i.a,{path:"/systems",component:Ee}),l.a.createElement(i.a,{component:A}))))},he=Object(C.a)((function(){return l.a.createElement("div",{style:{fontSize:30,paddingLeft:50,paddingTop:50}},l.a.createElement("p",null,l.a.createElement("button",{onClick:ge},B.get("course")?"On":"Off")),l.a.createElement("p",null,"Course: ",B.get("course")),l.a.createElement("p",null,"Heading: ",B.get("heading")),l.a.createElement("p",null,"Error: ",l.a.createElement("span",{style:{color:B.get("error")<0?"red":"green"}},B.get("error"))),l.a.createElement("p",null,l.a.createElement("button",{onClick:function(){return be(-1)}},"<--"),l.a.createElement("button",{style:{marginLeft:50},onClick:function(){return be(1)}},"--\x3e")))})),be=function(e){var t=B.get("course");(t+=e)>359&&(t=0),t<0&&(t=359),ve({course:t}),B.set("course",t)},ge=function(){return B.get("course")?ve({course:null}):ve({course:B.get("heading")})},ve=function(e){return p("AUTOPILOT",{data:e})},pe=function(){return l.a.createElement(i.c,null,l.a.createElement(i.a,{component:he}))};c.a.render(l.a.createElement((function(){return l.a.createElement(u.a,null,l.a.createElement(i.c,null,l.a.createElement(i.a,{path:"/mobile",component:pe}),l.a.createElement(i.a,{component:fe})))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[71,1,2]]]);
//# sourceMappingURL=main.895c686a.chunk.js.map